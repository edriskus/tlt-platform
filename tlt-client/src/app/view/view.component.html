<ng-container *ngIf="user$ | async as user">
  <ng-container *ngIf="post$ | async as post; else spinner">
    <div class="container pb-3" *ngIf="!editMode">
      <div class="row">
        <div class="col-lg-8">
          <h1>
            <span class="text-muted small link" routerLink="/"><i class="fas fa-caret-left"></i></span>
            {{ post.title }}
            <span *ngIf="user.token" class="link text-success h4" (click)="toggleEdit()"><i class="fas fa-marker"></i></span>
          </h1>
          <small>
            <span *ngIf="user.token"
              [class.text-warning]="!post.published"
              [class.text-success]="post.published">
            <i class="fas fa-circle"></i> </span>
            {{ formatDate(post.date) }}
          </small>
          <p class="pt-2 text-justify" Markdown [data]="post.content"></p>
        </div>
        <div class="d-none d-lg-block col-lg-4">
          <div class="sticky-sidebar" [class.stuck]="stickyIsFixed">
            <img [src]="post.image" onerror="this.src='/assets/plc7.png'" alt="" class="img-fluid">
            <small class="d-block">{{ post.imageDescription }}</small>
          </div>
        </div>
      </div>
    </div>
    <app-edit *ngIf="editMode" [post]="post" [user]="user" (close)="updatePost($event, post)"></app-edit>
  </ng-container>
  <ng-template #spinner>
    <div class="d-flex justify-content-center">
      <mat-spinner [strokeWidth]="2"
        [color]="'accent'"></mat-spinner>
    </div>
  </ng-template>
</ng-container>

